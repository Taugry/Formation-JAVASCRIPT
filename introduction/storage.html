<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation Javascript - Ecmascript</title>
    <link rel="stylesheet" href="../CSS/bootstrap.css">
    <link rel="stylesheet" href="../CSS/style.css">
    <script src="../JS/bootstrap.bundle.js"></script>
    <script src="../JS/script.js"></script>
    <script>
        //voir la session storage
        console.log(sessionStorage);

        loaded(function(){
            loadNav();
            let inputSessionUser = s('#sessionUser');
            let actualSessionUserName = s('#dataSessionUsername');
            //verifier les different storages
            if(sessionStorage.getItem('sessionUserName')){
                actualSessionUserName.innerText = sessionStorage.getItem('sessionUserName');
            }else{
                actualSessionUserName.innerText = 'Pas de sessionUserName enregistrer';
            }
            
            //session storage
            //sessionUser
            
            //console.log(inputSessionUser);

            s('#btnSession').addEventListener('click', function(){
                //console.log('click boutton session');
                if(inputSessionUser.value !== ''){
                    console.log('enregistrement en session du username');
                    sessionStorage.setItem('SessionUserName', inputSessionUser.value);
                    s('#dataSessionUsername').innerText = inputSessionUser.value;
                    inputSessionUser.value = '';
                }
            });
            
            //btn clear sessionusername
            s('#btnClearSessionUserName').addEventListener('click', function(){
                console.log('enlever username de la session');
                sessionStorage.removeItem('SessionUserName');
                actualSessionUserName.innerText = 'Pas de sessionUserName enregistrer';
            });

            //btn clear session
            s('#btnClearSession').addEventListener('click', function(){
                console.log('Nettoyage de la session');
                sessionStorage.clear();
                actualSessionUserName.innerText = 'session clear';
            });
//////////////////////////////////////local storage///////////////////////////////////////////////////////////////////////////
        console.log(localStorage);
            let inputlocalUser = s('#localUser');
            let actuallocalUserName = s('#datalocalUsername');
            if(localStorage.getItem('localUserName')){
                actuallocalUserName.innerText = localStorage.getItem('localUserName');
            }else{
                actuallocalUserName.innerText = 'Pas de localUserName enregistrer';
            }

            s('#btnlocal').addEventListener('click', function(){
                if(inputlocalUser.value !== ''){
                    console.log('enregistrement en local du username');
                    localStorage.setItem('localUserName', inputlocalUser.value);
                    s('#datalocalUsername').innerText = inputlocalUser.value;
                    inputlocalUser.value = '';
                }
            });
            
            //btn clear localusername
            s('#btnClearlocalUserName').addEventListener('click', function(){
                console.log('enlever username de la local');
                localStorage.removeItem('localUserName');
                actuallocalUserName.innerText = 'Pas de localUserName enregistrer';
            });

            //btn clear local
            s('#btnClearlocal').addEventListener('click', function(){
                console.log('Vider local');
                localStorage.clear();
                actuallocalUserName.innerText = 'Pas de localUserName enregistrer';
            });
        
        //////////////////////////////////////cookie///////////////////////////////////////////////////////////////////////////
        /*
        console.log(document.cookie);

        let cookieValue = 'Nico';
        //creation d'une date d'expiration
        let dateNow = new Date();
        console.log(dateNow);
        //1 * 24 * 60 * 60 * 1000
        dateNow.setTime(dateNow.getTime() + (1 * 24 * 60 * 60 * 1000));
        console.log(dateNow);
        //detruire prematurement un cookie, il faut le regler a une date anterieure a la date actuelle
        //creation d'une date anterieure
        let anteDateNow = new Date();
        console.log(anteDateNow);
        //1 * 24 * 60 * 60 * 1000
        anteDateNow.setTime(anteDateNow.getTime() - (1 * 24 * 60 * 60 * 1000));
        console.log(anteDateNow); 
        //creer un cookier qui expire a datenow
        document.cookie = `monCookie=${cookieValue}; expires=${dateNow.toUTCString()}; path=/introduction; SameSite=None; Secure`;
        //detruire le cookie
        //document.cookie = `monCookie=; expires=${anteDateNow.toUTCString()}; path=/introduction; SameSite=None; Secure`;
        */
        
        let inputCookieValue = s('#cookieValue').value;
        let dataCookieValue = s('#dataCookieValue');
        s('#btnCookie').addEventListener('click', function(){
            if(inputCookieValue.value !== ''){
                console.log(inputCookieValue)
                setCookie('monCookie', inputCookieValue, 1);
                inputCookieValue = '';
                dataCookieValue.innerText = getCookie('monCookie');
            }
        });

        //btnClearCookieValue
        s('#btnClearCookieValue').addEventListener('click', function(){
            setCookie('monCookie');
            dataCookieValue.innerText = '';
        });

        console.log(document.cookie);  
        let testCookie = getCookie('monCookie');

        if(!testCookie){
            dataCookieValue.innerText = '';
        }else{
            dataCookieValue.innerText = testCookie;
        }


        
    });
    </script>
</head>

<body>
    <header class="bg-ligth">
        <h1>Formation Javascript / Ecmascript</h1>
    </header>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
    </nav>

    <main class="container">
        <article class="col-lg-6">
            <header>
                <h2>le stockage des données en JS</h2>
            </header>
            <main>
                <h3>SessionStorage</h3>
                <p>
                    <label class="form-label">UserName:</label>
                    <input type="text" class="form-control" id="sessionUser" value="">
                </p>
                <p>
                    <button id="btnSession" class="btn btn-primary">Sauvegarder UserName en session</button>                   
                </p>
                <p>
                    <button id="btnClearSessionUserName" class="btn btn-warning">Clear SessionUserName</button>
                </p>
                <p>
                    <button id="btnClearSession" class="btn btn-danger">Clear SessionStorage</button>
                </p>
                <p>
                    Session UserName Actuel : <span id="dataSessionUsername"></span>
                </p>
            </main>
        </article>
        <article class="col-lg-6">
            <header>
                <h2>le stockage des données en JS</h2>
            </header>
            <main>
                <h3>LocalStorage</h3>
                <p>
                    <label class="form-label">UserName:</label>
                    <input type="text" class="form-control" id="localUser" value="">
                </p>
                <p>
                    <button id="btnlocal" class="btn btn-primary">Sauvegarder UserName en local</button>                   
                </p>
                <p>
                    <button id="btnClearlocalUserName" class="btn btn-warning">Clear localUserName</button>
                </p>
                <p>
                    <button id="btnClearlocal" class="btn btn-danger">Clear localStorage</button>
                </p>
                <p>
                    local UserName Actuel : <span id="datalocalUsername"></span>
                </p>
            </main>
        </article>
        <article class="col-lg-6">
            <header>
                <h2>le stockage des données en JS</h2>
            </header>
            <main>
                <h3>Cookie</h3>
                <p>
                    <label class="form-label">Cookie Value:</label>
                    <input type="text" class="form-control" id="cookieValue" value="">
                </p>
                <p>
                    <button id="btnCookie" class="btn btn-primary">Sauvegarder cookie value</button>                   
                </p>
                <p>
                    <button id="btnClearCookieValue" class="btn btn-warning">Clear cookie value</button>
                </p>
                <p>
                    Cookie Value Actuel : <span id="dataCookieValue"></span>
                </p>
            </main>
        </article>
    </main>

    <footer class="bg-light">
        &copy; Dawan 2021-11
    </footer>
</body>

</html>